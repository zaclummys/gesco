!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Gesco=t():r.Gesco=t()}(this,function(){"use strict";function r(r){return Object.prototype.toString.call(r)}function t(t){return"[object Array]"===r(t)}function n(t){return"[object Object]"===r(t)}function e(t){return"[object Function]"===r(t)}function o(t){return"[object String]"===r(t)}function u(r){if(t(r)===!1)throw new TypeError("first argument must be array");return r[r.length-1]}function i(r,t,o){if(n(r)===!1)throw new TypeError("first argument must be object");if(e(t)===!1)throw new TypeError("callback must be function");for(var u in r)r.hasOwnProperty(u)&&t.call(o,r[u],u,r)}function c(r,t,o){if(n(r)===!1)throw new TypeError("first argument must be object");if(e(t)===!1)throw new TypeError("callback must be function");var u={};return i(r,function(n,e){u[e]=t.call(this,n,e,r)},o),u}function f(r,e){var o,u;if(n(r)===!1)throw new TypeError("first argument must be object");if(t(e)===!1)throw new TypeError("path must be array");for(u=0;u<e.length;u++){if(o=String(e[u]),r=Object(r),!(o in r))return!1;r=r[o]}return!0}function a(r,e){var o,u;if(n(r)===!1)throw new TypeError("first argument must be object");if(t(e)===!1)throw new TypeError("path must be array");if(f(r,e)!==!1){for(u=0;u<e.length;u++)o=String(e[u]),r=Object(r),r=r[o];return r}}function s(r,e,o){var i,c;if(t(e)===!1)throw new TypeError("path must be array");if(1===e.length?(i=r,c=e):(i=a(r,e.slice(0,-1)),c=u(e)),n(i)===!1)throw new Error("top-level property must be object");if(null==c)throw new Error("base property key is null");i[c]=o}function p(r){var n;if(null==r||0===r.length)throw new TypeError("path is null");if(o(r)===!1&&t(r)===!1)throw new TypeError("path must be string or array");if(n=t(r)?r.every(function(r){return o(r)&&r.includes(E)===!1}):r.includes(E+E)===!1)return!0;throw new Error("path error")}function l(r){if(p(r))return o(r)?r.split(E):r}function b(r){if(p(r))return t(r)?r.join(E):r}function w(r,t){return r=l(r),t=l(t),r.every(function(r,n){return r===t[n]})}function h(r,t,o){if(n(r)===!1)throw new TypeError("first argument must be object");if(e(t)===!1)throw new TypeError("matching callback must be function");if(e(o)===!1)throw new TypeError("checking callback must be function");i(r,function(n,e){o(e)&&t(n,e,r)})}function y(r,t){return Array.prototype.slice.call(r,t)}function m(){function r(r,t){Object.defineProperty(v,r,{value:t})}function t(r){return r.apply(v,y(arguments,1))}function o(r,n,e){return function(o){s(d,l(r),t(e,o,b(r),b(n)))}}function u(r,t,n){if(2===arguments.length&&(n=t,t=r),r=b(r),t=b(t),!e(n))throw new TypeError("computer must be function");f(t).push(o(r,t,n))}function i(r){return b(r)in k}function f(r){return r=b(r),i(r)===!1&&(k[r]=[]),k[r]}function p(r){r=b(r);var t=y(arguments,1),n=f(r);t.forEach(function(r){if(!e(r))throw new TypeError("observer must be function");n.push(r)})}function m(r){var n=l(r);h(k,function(r,n){r.forEach(function(r){t(r,g(n),n)})},w.bind(null,n))}function E(r,n){if(n){if(!e(n))throw new TypeError("callback must be function");t(n,g(r)),m(r)}else m(r)}function g(r){return void 0===r?d:a(d,l(r))}function j(r,t,e){return n(r)?c(r,function(r,t){return j(t,r)}):(r=l(r),e&&p(r,e),s(d,r,t),m(r),t)}function T(){return JSON.stringify(d)}var v={},d={},k={};return r("get",g),r("set",j),r("observe",p),r("compute",u),r("emit",E),r("toString",T),v}var E=".";return m});