!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Gesco=t():r.Gesco=t()}(this,function(){"use strict";function r(r){return Object.prototype.toString.call(r)}function t(t){return"[object Array]"==r(t)}function n(t){return"[object Object]"==r(t)}function e(t){return"[object Function]"==r(t)}function o(t){return"[object String]"==r(t)}function u(r){if(0==t(r))throw new TypeError("first argument must be array");return r[r.length-1]}function i(r,t,o){if(0==n(r))throw new TypeError("first argument must be object");if(0==e(t))throw new TypeError("callback must be function");for(var u in r)r.hasOwnProperty(u)&&t.call(o,r[u],u,r)}function f(r,t,o){if(0==n(r))throw new TypeError("first argument must be object");if(0==e(t))throw new TypeError("callback must be function");var u={};return i(r,function(n,e){u[e]=t.call(this,n,e,r)},o),u}function c(r,e){var o,u;if(0==n(r))throw new TypeError("first argument must be object");if(0==t(e))throw new TypeError("path must be array");for(u=0;u<e.length;u++){if(o=String(e[u]),r=Object(r),!(o in r))return!1;r=r[o]}return!0}function a(r,e){var o,u;if(0==n(r))throw new TypeError("first argument must be object");if(0==t(e))throw new TypeError("path must be array");if(0!=c(r,e)){for(u=0;u<e.length;u++)o=String(e[u]),r=Object(r),r=r[o];return r}}function s(r,e,o){var i,f;if(0==t(e))throw new TypeError("path must be array");if(1===e.length?(i=r,f=e):(i=a(r,e.slice(0,-1)),f=u(e)),0==n(i))throw new Error("top-level property must be object");if(null==f)throw new Error("base property key is null");i[f]=o}function p(r){if(null==r||0==r.length)throw new TypeError("path is null");if(0==o(r)&&0==t(r))throw new TypeError("path must be string or array");if(t(r))var n=r.every(function(r){return o(r)&&r.includes(E)===!1});else var n=r.includes(E+E)===!1;if(n)return!0;throw new Error("path error")}function l(r){if(p(r))return o(r)?r.split(E):r}function b(r){if(p(r))return t(r)?r.join(E):r}function w(r,t){var r=l(r),t=l(t);return r.every(function(r,n){return r===t[n]})}function h(r,t,o){if(0==n(r))throw new TypeError("first argument must be object");if(0==e(t))throw new TypeError("matching callback must be function");if(0==e(o))throw new TypeError("checking callback must be function");i(r,function(n,e){o(e)&&t(n,e,r)})}function y(r,t){return Array.prototype.slice.call(r,t)}function m(){function r(r){return r.apply(j,y(arguments,1))}function t(t,n,e){return function(o){s(T,l(t),r(e,o,b(t),b(n)))}}function o(r,n,o){var r,n,o;if(2===arguments.length&&(o=n,n=r),r=b(r),n=b(n),!e(o))throw new TypeError("computer must be function");i(n).push(t(r,n,o))}function u(r){return b(r)in d}function i(r){var r=b(r);return 0==u(r)&&(d[r]=[]),d[r]}function c(r){var r=b(r),t=y(arguments,1),n=i(r);t.forEach(function(r){if(!e(r))throw new TypeError("observer must be function");n.push(r)})}function p(t){var n=l(t);h(d,function(t,n){t.forEach(function(t){r(t,E(n),n)})},w.bind(null,n))}function m(t,n){if(n){if(!e(n))throw new TypeError("callback must be function");r(n,E(t)),p(t)}else p(t)}function E(r){return void 0===r?T:a(T,l(r))}function g(r,t,e){if(n(r))return f(r,function(r,t){return g(t,r)});var r=l(r);return e&&c(r,e),s(T,r,t),p(r),t}function v(){return JSON.stringify(T)}var j={},T={},d={};return j.get=E,j.set=g,j.observe=c,j.compute=o,j.emit=m,j.toString=v,j}var E=".";return m});